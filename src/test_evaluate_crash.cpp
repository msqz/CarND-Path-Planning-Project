#include <assert.h>
#include <iostream>
#include <vector>
#include "constraints.h"
#include "cost.h"
#include "localization.h"
#include "obstacle.h"
#include "path.h"

void given_overlapping_paths_returns_crash() {
  Path path;
  path.s = {416.3264,417.147806845945,417.970375820983,418.794100965184,419.618978470638,420.445006611245,421.27218567251,422.100517881334,422.930007335809,423.760659935006,424.592483308774,425.425486747529,426.259681132048,427.09507886326,427.931693792041,428.769541149007,429.608637474304,430.449000547405,431.290649316897,432.13360383028,432.977885163756,433.823515352022,434.670517318065,435.518914802951,436.368732295623,437.219994962689,438.072728578217,438.926959453527,439.782714366985,440.640020493795,441.498905335791,442.359396651232,443.221522384591,444.085310596353,444.950789392803,445.817986855822,446.686930972677,447.557649565817,448.430170222662,449.3045202254,450.180726480778,451.058815449892,451.938813077983,452.820744724231,453.704635091544,454.590508156353,455.478387098405,456.368294230553,457.260250928555,458.154277560858,459.0503934184,459.948616644395,460.848964164131,461.75145161476,462.656093275092,463.562901995388,464.471889127152,465.383064452922,466.296436116069,467.212010550582,468.129792410867,469.049784501535,469.971987707197,470.89640092226,471.823020980713,472.751842585925,473.682858240436,474.616058175749,475.551430282125,476.488960038375,477.42863044165,478.370421937239,479.314312348355,480.260276805935,481.208287678429,482.158314501593,483.11032390828,484.064279558238,485.020142067896,485.977868940165,486.937414494222,487.89872979531,488.861762584524,489.826457208612,490.792754549761,491.760591955391,492.729903167951,493.700618254709,494.672663537545,495.645961522745,496.620430830792,497.595986126162,498.572538047111,499.549993135475,500.528253766457,501.507218078424,502.486779902694,503.466828693338,504.447249456962,505.427922682508};

  path.d = {5.99999999998589,6.00003940238607,6.00031047678627,6.00103198318648,6.00240885758671,6.00463249998695,6.0078810623872,6.01231973678747,6.01810104318774,6.02536511758802,6.03423999998831,6.04484192238861,6.05727559678891,6.07163450318922,6.08800117758953,6.10644749998984,6.12703498239016,6.14981505679048,6.17482936319079,6.20211003759111,6.23167999999143,6.26355324239174,6.29773511679205,6.33422262319236,6.37300469759267,6.41406249999297,6.45736970239327,6.50289277679357,6.55059128319386,6.60041815759414,6.65231999999442,6.70623736239469,6.76210503679496,6.81985234319522,6.87940341759548,6.94067749999572,7.00358922239596,7.0680488967962,7.13396280319642,7.20123347759664,7.26975999999685,7.33943828239705,7.41016135679725,7.48181966319744,7.55430133759762,7.62749249999779,7.70127754239795,7.77553941679811,7.85015992319826,7.9250199975984,7.99999999999854,8.07498000239867,8.14984007679878,8.2244605831989,8.29872245759901,8.37250749999911,8.4456986623992,8.51818033679929,8.58983864319937,8.66056171759944,8.73023999999951,8.79876652239958,8.86603719679963,8.93195110319969,8.99641077759974,9.05932249999978,9.12059658239982,9.18014765679985,9.23789496319989,9.29376263759991,9.34767999999994,9.39958184239995,9.44940871679997,9.49710722319999,9.5426302976,9.58593750000001,9.62699530240002,9.66577737680002,9.70226488320002,9.73644675760003,9.76832000000003,9.79788996240003,9.82517063680003,9.85018494320003,9.87296501760002,9.89355250000003,9.91199882240002,9.92836549680002,9.94272440320001,9.95515807760001,9.96576000000001,9.97463488240001,9.98189895680001,9.9876802632,9.9921189376,9.9953675,9.9975911424,9.9989680168,9.9996895232,9.9999605976};

  Localization localization;
  localization.s = 416.326;
  localization.d = 6.0;

  Prediction prediction;

  prediction.id = 3;
  prediction.s = 421.698;
  prediction.s_original = 421.698;
  prediction.d = 5.98703;
  prediction.d_original = 5.98703;
  
  double cost = evaluate_crash(path, localization, {prediction});

  assert(abs(cost - 1.0) < 0.000);
}


int main() {
  given_overlapping_paths_returns_crash();
  std::cout << "done" << std::endl;

  return 0;
}
